---
---
<div id="callback-return-display">

</div>


<script>
    const clientId = '0f4d20ae24b10b1b1e45';
    const clientSecret = '698886ef07bc854459044d012b5be122472795f6';
    const redirect = 'https://akibrhast.github.io/github-issue-submission-form/callback';
    const githubpost = 'https://secure-brook-93015.herokuapp.com/https://github.com/login/oauth/access_token';

    (async function(){
        const urlParams = Object.fromEntries(new URLSearchParams(window.location.search));
        let res = await axios.post(githubpost, {
                            client_id: clientId,
                            client_secret: clientSecret,
                            redirect_uri:redirect,
                            code: urlParams.code
                    },
                    {    
                        headers: {'Accept': 'application/json' }
                    }
                )
        localStorage.setItem('github-cred',res.data)
        if(localStorage.getItem('github-cred').length > 0){
            document.querySelector('#callback-return-display').innerHTML=`
                <p><strong>Callback return data has been successfully stored in local storage</strong></p>
                <p>You will now be redirected to the issue submission page in -- <span id='timer'></span> seconds</p>
            `;
            redirectTimer();
        }
    })()

    function redirectTimer(){
        let counter = 5;
        let interval = setInterval(function() {
            counter--;
            document.querySelector('#timer').append(counter)
            // Display 'counter' wherever you want to display it.
            if (counter == 0) {
                clearInterval(interval);
                window.location.replace("https://akibrhast.github.io/github-issue-submission-form/issue.html");
            }
        }, 1000);

    }

</script>