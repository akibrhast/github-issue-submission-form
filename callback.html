---
---
<div id="callback-return-display">

</div>


<script>
    const githubpost = `${BASE_CORS_URI}https://github.com/login/oauth/access_token`;
    (async function(){
        const urlParams = Object.fromEntries(new URLSearchParams(window.location.search));
        let res = await axios.post(githubpost, {
                            client_id: CLIENT_ID,
                            client_secret: CLIENT_SECRET,
                            redirect_uri:REDIRECT_URI,
                            code: urlParams.code
                    },
                    {    
                        headers: {'Accept': 'application/json' }
                    }
                )
        localStorage.setItem('github-cred',JSON.stringify(res.data))
        if(localStorage.getItem('github-cred').length > 0){
            document.querySelector('#callback-return-display').innerHTML=`
                <p><strong>Callback return data has been successfully stored in local storage</strong></p>
                <p>You will now be redirected to the issue submission page in -- <span id='timer'></span> seconds</p>
            `;
            redirectTimer();
        }
    })()

    function redirectTimer(){
        let counter = 5;
        let interval = setInterval(function() {
            counter--;
            document.querySelector('#timer').append(counter)
            // Display 'counter' wherever you want to display it.
            if (counter == 0) {
                clearInterval(interval);
                window.location.replace("https://akibrhast.github.io/github-issue-submission-form/issue.html");
            }
        }, 1000);

    }

</script>